<div class="top-spacing">
    <div class="w-100">
        <div style="overflow-x: hidden;">
            <div class="row">
                <div class="col">
                    <i style="font-size: 30px; cursor: pointer;" (click)="back()" class="fa fa-arrow-circle-left"
                        aria-hidden="true"></i>
                </div>
            </div>
            <div class="row">
                <span class="col">
                    <p class="heading">{{taskDetail.processName}} : {{taskDetail.actionRequiredDescription}} -
                        <a (click)="navigateTaskProfile()"
                            style="color: blue; cursor: pointer !important;">{{taskDetail.referenceNo}}</a>
                    </p>
                </span>
            </div>

            <div class="card cardNew">
                <div class="row detail" id="desktop-tab">
                    <div [ngClass]="[showSideCollapser ? '' : 'small']" class="p-0 left-col">
                        <div class="collapser">
                            <mat-icon (click)="showSideCollapser=!showSideCollapser">
                                {{showSideCollapser ? 'chevron_left' : 'chevron_right'}}
                            </mat-icon>
                        </div>
                        <div *ngFor='let item of menuItems'>
                            <div class="row">
                                <div class="col-md-12">
                                    <div (click)="changeTab(item.id)" [ngClass]="[item.isActive ? 'link-active' : '']"
                                        class="row profile-link left-col-button">
                                        <div class="col-md-2">
                                            <img [src]="item.isActive ? item.activeIconUrl : item.inActiveIconUrl"
                                                alt="" class="my-2 image">
                                        </div>
                                        <div *ngIf="showSideCollapser" class="col-md-10">
                                            <p class="desc-text m-0">{{item.title}}</p>
                                            <input type="checkbox" hidden id="{{item.title}}">
                                            <p class="info-text m-0 truncate">{{item.description}}</p>
                                            <label for="{{item.title}}" style="font-family: roboto;font-size: 12px;"
                                                role="button">read more</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div [ngClass]="[showSideCollapser ? '' : 'big']" class="right-col">
                        <!-- <div class="row">
                    <div class="col-md-10"> -->
                        <div *ngIf="activeTabId == 1 && taskDetail.processName !== 'Referral Task'"
                            style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Request Logged by
                                {{this.requestorInformation?.requestLoggedBy?.firstName === null ? '':
                                this.requestorInformation?.requestLoggedBy?.firstName + ' ' +
                                this.requestorInformation?.requestLoggedBy?.surName === null ? '' :
                                this.requestorInformation?.requestLoggedBy?.surName}}</p>
                            <!-- <p class="sub-heading">Type: </p> -->
                            <div class="row mx-0">
                                <div class="col-8">
                                    <form [formGroup]="RequestersInfo">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Email</mat-label>
                                            <input formControlName="email" matInput readonly />
                                        </mat-form-field>
                                        <span class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>First Name</mat-label>
                                                    <input formControlName="firstName" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                            <span class="col-6 pr-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Last Name</mat-label>
                                                    <input formControlName="lastName" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                        </span>
                                        <span class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Phone</mat-label>
                                                    <input formControlName="phone" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                        </span>
                                    </form>
                                </div>
                            </div>
                            <hr />
                            <div class="row" *ngIf="requestor !== undefined">
                                <div class="col-12 col-md-6 col-lg-4 m-t-10">
                                    <p>Are you the requestor of data?</p>
                                </div>
                                <div class="col-12 col-md-6 col-lg-4 m-t-10">
                                    <mat-radio-group disabled [(ngModel)]="requestor">
                                        <mat-radio-button class="m-r-10" value="Yes">Yes</mat-radio-button>
                                        <mat-radio-button value="No">No</mat-radio-button>
                                    </mat-radio-group>
                                </div>
                            </div>
                            <form [formGroup]="requesterForm">
                                <div *ngIf="requestor === 'No' || requestor === undefined" class=" m-t-10">
                                    <div class="row">
                                        <div *ngIf="requestor === 'No'" class="col-12 col-md-6 col-lg-4">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Requestor</mat-label>
                                                <mat-select disabled [(ngModel)]="requestorClient"
                                                    [ngModelOptions]="{ standalone: true }" matInput>
                                                    <mat-option [value]="requestorClient">
                                                        {{requestorClient}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Requestor Name</mat-label>
                                                <input readonly formControlName="requesterName" matInput />
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Requestor Surname</mat-label>
                                                <input readonly formControlName="requesterSurame" matInput required />
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'SMS' ||
                                            requestorClient == 'TELEPHONE'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Contact Number</mat-label>
                                                <input readonly formControlName="contactNumber" matInput />
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'EMAIL'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Email</mat-label>
                                                <input readonly formControlName="Email" matInput />
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'FAX'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Fax</mat-label>
                                                <input readonly formControlName="Fax" matInput />
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'POST' ||
                                            requestorClient == 'COURIER'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Address Line 1</mat-label>
                                                <input readonly formControlName="Address1" matInput />
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'POST' ||
                                            requestorClient == 'COURIER'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Address Line 2</mat-label>
                                                <input readonly formControlName="Address2" matInput />
                                            </mat-form-field>
                                        </div>
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'POST' ||
                                            requestorClient == 'COURIER'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Address Line 3</mat-label>
                                                <input readonly formControlName="Address3" matInput />
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12 col-md-6 col-lg-4" *ngIf="
                                            requestorClient == 'ANONYMOUS' ||
                                            requestorClient == 'POST' ||
                                            requestorClient == 'COURIER'
                                          ">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Postal Code</mat-label>
                                                <input readonly formControlName="PostalCode" matInput />
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <p class="sub-heading">Delivery Information </p>
                            <div class="row mx-0">
                                <div class="col-8">
                                    <form [formGroup]="RequestersInfo">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Request Type</mat-label>
                                            <input formControlName="requestType" matInput readonly />
                                        </mat-form-field>
                                        <span *ngIf="taskDetail.processName == 'Information Request'" class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Delivery Method</mat-label>
                                                    <input formControlName="deliveryMethod" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                            <span class="col-6 pr-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Data Delivery Media</mat-label>
                                                    <input formControlName="formatType" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                        </span>
                                        <div
                                            *ngIf="requestorInformation?.deliveryMethod != 'ELECTRONIC' && requestorInformation?.deliveryMethod != 'COLLECTION'">
                                            <mat-form-field appearance="outline" class="input-margin"
                                                *ngIf="taskDetail.processName == 'Information Request' && requestorInformation?.deliveryMethod != 'COLLECTION'">
                                                <mat-label>Phone</mat-label>
                                                <input formControlName="phone" matInput readonly />
                                            </mat-form-field>
                                            <mat-form-field appearance="outline" class="input-margin"
                                                *ngIf="taskDetail.processName == 'Information Request'">
                                                <mat-label>Collection Address</mat-label>
                                                <input formControlName="collectionAddress" matInput readonly />
                                            </mat-form-field>
                                            <span *ngIf="taskDetail.processName == 'Information Request'"
                                                class="row mx-0">
                                                <span class="col-6 pl-0"
                                                    *ngIf="RequestersInfo.value.add1 !== undefined">
                                                    <mat-form-field appearance="outline" class="input-margin">
                                                        <mat-label>Address 1</mat-label>
                                                        <input formControlName="add1" matInput readonly />
                                                    </mat-form-field>
                                                </span>
                                                <span class="col-6 pr-0"
                                                    *ngIf="RequestersInfo.value.add2 !== undefined">
                                                    <mat-form-field appearance="outline" class="input-margin">
                                                        <mat-label>Address 2</mat-label>
                                                        <input formControlName="add2" matInput readonly />
                                                    </mat-form-field>
                                                </span>
                                            </span>

                                            <span *ngIf="taskDetail.processName == 'Information Request'"
                                                class="row mx-0">
                                                <span class="col-6 pl-0"
                                                    *ngIf="RequestersInfo.value.add3 !== undefined">
                                                    <mat-form-field appearance="outline" class="input-margin">
                                                        <mat-label>Address 3</mat-label>
                                                        <input formControlName="add3" matInput readonly />
                                                    </mat-form-field>
                                                </span>
                                                <span class="col-6 pr-0"
                                                    *ngIf="RequestersInfo.value.zipcode !== undefined">
                                                    <mat-form-field appearance="outline" class="input-margin">
                                                        <mat-label>Zip Code</mat-label>
                                                        <input formControlName="zipcode" matInput readonly />
                                                    </mat-form-field>
                                                </span>
                                            </span>
                                        </div>
                                    </form>
                                    <div class="row">
                                        <div class="col-12" *ngIf="ownMedia !== undefined">
                                            <p>I will give my own media to department : {{ownMedia}}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="activeTabId == 1 && taskDetail.processName === 'Referral Task'"
                            style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Request Logged by
                                {{this.requestorInformation?.requestLoggedBy?.firstName === null ? '':
                                this.requestorInformation?.requestLoggedBy?.firstName + ' ' +
                                this.requestorInformation?.requestLoggedBy?.surName === null ? '' :
                                this.requestorInformation?.requestLoggedBy?.surName}}</p>
                            <!-- <p class="sub-heading">Type: </p> -->
                            <div class="row mx-0">
                                <div class="col-8">
                                    <form [formGroup]="RequestersInfo">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Email</mat-label>
                                            <input formControlName="email" matInput readonly />
                                        </mat-form-field>
                                        <span class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>First Name</mat-label>
                                                    <input formControlName="firstName" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                            <span class="col-6 pr-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Last Name</mat-label>
                                                    <input formControlName="lastName" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                        </span>
                                        <span class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Phone</mat-label>
                                                    <input formControlName="phone" matInput readonly />
                                                </mat-form-field>
                                            </span>
                                        </span>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="activeTabId == 2 && nodeDetails?.FormID == 10"
                            style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">{{nodeDetails.formName}}</p>
                            <div class="row mx-0">
                                <div class="col-8">
                                    <form [formGroup]="notifyReview">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Email</mat-label>
                                            <input formControlName="email" matInput readonly />
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Name</mat-label>
                                            <input formControlName="name" matInput readonly />
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Search Type Name</mat-label>
                                            <input formControlName="searchTypeName" matInput readonly />
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Search Number</mat-label>
                                            <input formControlName="searchNumber" matInput readonly />
                                        </mat-form-field>


                                        <!-- <span *ngIf="taskDetail.processName == 'Information Request'" class="row mx-0">
                                            <span class="col-6 pl-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Address 3</mat-label>
                                                    <input formControlName="add3" matInput readonly>
                                                </mat-form-field>
                                            </span>
                                            <span class="col-6 pr-0">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Zip Code</mat-label>
                                                    <input formControlName="zipcode" matInput readonly>
                                                </mat-form-field>
                                            </span>
                                        </span> -->
                                    </form>
                                </div>
                            </div>
                            <!-- <div class="row mx-0 absolute absoluteNew">
                                <div class="col p-0">
                                    <div>
                                        <button class="submit-button btn1 submit float-right">Submit</button>
                                        <button class="back-button btn1 cancel float-right"
                                            (click)="close()">Cancel</button>
                                    </div>
                                </div>
                            </div> -->
                        </div>

                        <div *ngIf="activeTabId == 2 && nodeDetails.FormID == 11"
                            style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">{{nodeDetails.formName}}</p>
                            <span style="color:#f48222">This information is request for reference number <a
                                    (click)="navigateReferralTaskProfile(referralInput)"
                                    style="text-decoration: none; color: blue; cursor: pointer !important;">{{referralInput?.referenceNo}}</a>.
                                <span style="color: #4680FF">Please click on reference number to view
                                    details.</span></span>
                            <!-- <div class="row mx-0">
                                <div class="col-8">
                                    <form [formGroup]="referralInput">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Email</mat-label>
                                            <input formControlName="email" matInput readonly />
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Name</mat-label>
                                            <input formControlName="name" matInput readonly />
                                        </mat-form-field>
                                    </form>
                                </div>
                            </div> -->
                        </div>

                        <div *ngIf="activeTabId == 2" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <div *ngIf="nodeDetails.FormID == 2">
                                <p class="sub-heading">{{nodeDetails.formName}}</p>
                                <div *ngFor="let item of infoReview;let i = index ">
                                    <div class="row mt-3" *ngIf="item.templateListItemId !== 567">
                                        <div class="col-12 col-md-4" *ngIf="item.searchDetails != undefined">
                                            <!-- <div class="row">
                                                <img [src]="item.searchDetails.tempPreview?.preview" alt=""
                                                    class="main-image"
                                                    matTooltip="{{item.searchDetails.tempPreview?.scanDate | date : 'dd/MMMM/y HH:mm:ss' }}">
                                            </div> -->
                                            <div class="gallery-wrapper" style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                            -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                            border-color: rgba(0,0,0,.2);">
                                                <ngx-skeleton-loader *ngIf="showImageLoader" count="5"
                                                    appearance="circle" [theme]="{
                                                width: '70px',
                                                height: '70px',
                                                'border-radius': '10px'
                                              }"></ngx-skeleton-loader>
                                                <ngx-gallery *ngIf="!showImageLoader" #gallery
                                                    [options]="galleryOptions" [images]="item.searchDetails.imageArray"
                                                    class="ngx-gallery"></ngx-gallery>
                                            </div>
                                            <span class="row justify-content-center mt-3">
                                                <button mat-raised-button
                                                    (click)="openViewMapDialog(item.searchDetails)"
                                                    class="yellow-button bmapover">View Map</button>
                                                <button mat-raised-button class="yellow-button bmapover"
                                                    style="cursor: pointer !important;" (click)="navigate(item)">View
                                                    Profile</button>
                                            </span>
                                            <!-- <div class="row" style="margin-top: 16px;">
                                                <div *ngFor="let img of item.searchDetails.imageArray"
                                                    class="col-3 pr-1">
                                                    <img (click)="selectImage($event)"
                                                        [ngClass]="item.searchDetails.tempPreview.preview === img.preview ? 'selected-image' : 'bottom-image'"
                                                        [src]="img.thumbnail" alt="" id="{{img.preview}}">
                                                </div>
                                            </div> -->
                                        </div>
                                        <div class="col col-md-8" *ngIf="item.searchDetails != undefined">
                                            <div class="row">
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Region</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.region !== undefined ?
                                                                item.searchDetails.region :
                                                                item.searchDetails.minorRegion :
                                                                ''}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel Type</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.parcelType : ''}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel</p>
                                                            <p class="desc-text mt-0">{{(item.searchDetails.parcel !=
                                                                null
                                                                && item.searchDetails.parcel != undefined) ?
                                                                item.searchDetails.parcel :
                                                                (item.searchDetails.erfNumber != null &&
                                                                item.searchDetails.erfNumber != undefined ?
                                                                item.searchDetails.erfNumber :
                                                                (item.searchDetails.farmNumber != null &&
                                                                item.searchDetails.farmNumber != undefined ?
                                                                item.searchDetails.farmNumber :
                                                                item.searchDetails.holdingNumber))}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Province</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.province}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">SG Number</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.sgNo}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">File Size (KB)</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails.totalFileSize}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Total Pages</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.totalPages}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">LPI</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.lpi}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Municipality</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.localMunicipalityName}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Portion</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails?.portion}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentType}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Sub Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentSubType}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box"
                                                    *ngIf="item.searchDetails.filterName != undefined">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">{{item.searchDetails?.filterName}}
                                                            </p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.searchNumber}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div *ngIf="item.cartData.diagrams" class="col-12 col-md-12 mt-5">
                                                    <div class="row">
                                                        <div class="col text">CADASTRAL IMAGES</div>
                                                    </div>
                                                    <div class="row mx-0" style="margin-top: 43px;">
                                                        <div class="col-12 p-0">
                                                            <!-- <div> -->
                                                            <table [dataSource]="item.cartData.diagramsData"
                                                                class="table-margin" mat-table style="width: 100%;">
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell
                                                                        style="width: 33%;">Sno.
                                                                    </th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="format">
                                                                    <th *matHeaderCellDef mat-header-cell
                                                                        style="width: 33%;">Format
                                                                    </th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.format?.caption}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell
                                                                        style="width: 34%;">Type
                                                                    </th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.type?.caption}}</td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="diagramColumns" mat-header-row>
                                                                </tr>
                                                                <tr *matRowDef="let row; columns: diagramColumns;"
                                                                    mat-row>
                                                                </tr>
                                                            </table>
                                                            <!-- </div> -->
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.general" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">General Data</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <table [dataSource]="item.cartData.generalData"
                                                                class="w-100" mat-table>
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="format">
                                                                    <th *matHeaderCellDef mat-header-cell>Format</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.format?.caption}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell>Type</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.type?.caption}}</td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="columnType1" mat-header-row></tr>
                                                                <tr *matRowDef="let row; columns: columnType1;" mat-row>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.certificates" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Certificates Data</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <table [dataSource]="item.cartData.certificatesData"
                                                                class="w-100" mat-table>
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="certType">
                                                                    <th *matHeaderCellDef mat-header-cell>Certificate
                                                                        Type
                                                                    </th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element.certType.caption}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="format">
                                                                    <th *matHeaderCellDef mat-header-cell>Format</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.format?.caption}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell>Type</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element?.type?.caption}}</td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="columnType2" mat-header-row></tr>
                                                                <tr *matRowDef="let row; columns: columnType2;" mat-row>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.spatial" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Spatial Data</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <table [dataSource]="item.cartData.spatialData"
                                                                class="w-100" mat-table>
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell>Type</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element.type.caption}}</td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="columnType3" mat-header-row></tr>
                                                                <tr *matRowDef="let row; columns: columnType3;" mat-row>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.coordinates" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Coordinates Data</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <table [dataSource]="item.cartData.coordinateData"
                                                                class="w-100" mat-table>
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell>Type</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element.type.caption}}</td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="columnType3" mat-header-row></tr>
                                                                <tr *matRowDef="let row; columns: columnType3;" mat-row>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.alphaNumerics" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Alpha-Numerics Data</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <table [dataSource]="item.cartData.alphaNumericsData"
                                                                class="w-100" mat-table>
                                                                <ng-container matColumnDef="sno">
                                                                    <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                                    <td *matCellDef="let element;let i = index;"
                                                                        mat-cell>
                                                                        {{i + 1}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="type">
                                                                    <th *matHeaderCellDef mat-header-cell>Type</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        {{element.type.caption}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="action">
                                                                    <th *matHeaderCellDef mat-header-cell>Action</th>
                                                                    <td *matCellDef="let element" mat-cell>
                                                                        <mat-icon (click)="delete()" class="icon-css"
                                                                            matTooltip="Delete Item">
                                                                            delete
                                                                        </mat-icon>
                                                                    </td>
                                                                </ng-container>
                                                                <tr *matHeaderRowDef="columnType3" mat-header-row></tr>
                                                                <tr *matRowDef="let row; columns: columnType3;" mat-row>
                                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.advisory" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Advisory</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Advisory</mat-label>
                                                                <input [value]="item.cartData.advisoryData" disabled
                                                                    matInput />
                                                            </mat-form-field>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.cartData.misc" class="col-12 col-lg-6 mt-5">
                                                    <div class="row">
                                                        <div class="col text">Miscellaneous</div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Miscellaneous</mat-label>
                                                                <input [value]="item.cartData.miscData" disabled
                                                                    matInput />
                                                            </mat-form-field>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>




                                    <div class="row mt-3" *ngIf="item.templateListItemId === 567">
                                        <div class="col-12 col-md-4">
                                            <div class="row">
                                                <div class="gallery-wrapper"
                                                    style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                border-color: rgba(0,0,0,.2);height: 380px;width: 300px;">
                                                    <span fxLayoutAlign="center center">No Preview available</span>

                                                </div>
                                            </div>

                                        </div>
                                        <div class="col col-md-8">
                                            <div class="row">
                                                <div class="col-12 col-md-12 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <span class="info-text">Category</span>
                                                            <br>
                                                            <span
                                                                class="desc-text">{{item.searchDetails?.categoryName}}</span>
                                                        </span>
                                                        <span class="col">
                                                            <span class="info-text">Subcategory</span>
                                                            <br>
                                                            <span class="desc-text">{{item.searchDetails?.name}}</span>
                                                        </span>
                                                    </span>
                                                </div>

                                                <div class="col-12 col-md-12 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <span class="desc-text"><b>Description</b></span>
                                                            <br>
                                                            <span
                                                                class="info-text">{{item.searchDetails?.description}}</span>
                                                        </span>
                                                    </span>
                                                </div>

                                                <div class="col-12 col-md-12 gray-box">
                                                    <span class="desc-text"><b>Information Type</b></span>

                                                    <span class="row info-text">
                                                        <div class="col-12 col-md-6">
                                                            <!-- <mat-checkbox [checked]='true' [disableRipple]="true"
                                                                (click)="$event.preventDefault()"> -->
                                                            <span>{{item.searchDetails?.categoryName}}
                                                                <b>{{searchDetails?.name}}</b> </span>
                                                            <!-- </mat-checkbox> -->
                                                        </div>
                                                    </span>
                                                    <div class="row">
                                                        <div class="col-12 col-md-6">
                                                            <span class="row">
                                                                <span class="col">
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Format</mat-label>
                                                                        <mat-select matInput disabled
                                                                            [(ngModel)]="item.cartData.ngiData.format != null?item.cartData.ngiData.format.itemId:item.cartData.ngiData.format">
                                                                            <mat-option *ngFor="let y of formatType"
                                                                                [value]="y!= null?y.itemId:y">
                                                                                {{y.caption}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </span>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-12 col-md-12 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <span class="desc-text"><b>Notes</b></span>
                                                            <br>
                                                            <div class="row f-css">
                                                                <mat-form-field appearance="outline">
                                                                    <!-- <mat-label>Notes</mat-label> -->
                                                                    <textarea [(ngModel)]="item.cartData.ngiData.notes"
                                                                        matInput style="color: black;"
                                                                        disabled></textarea>
                                                                    <!-- <span class="pull-right char"
                                                                        style="color: black;"><em>{{ 1000 -
                                                                            notes?.length }} characters
                                                                            left</em></span> -->
                                                                </mat-form-field>
                                                            </div>
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="row my-3">
                        <div class="col">
                            <span class="float-right">
                                <button class="back-button" style="height: 44px; margin-right: 5px;">Save</button>
                                <button class="submit-button" style="height: 44px; margin-left: 5px;">Submit</button>
                            </span>
                        </div>
                    </div> -->
                        </div>

                        <div *ngIf="activeTabId == 2" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <div *ngIf="nodeDetails.FormID == 6">
                                <p class="sub-heading">{{nodeDetails.formName}}</p>

                                <form [formGroup]="uploadpaymentform">
                                    <div class="row  mx-0">
                                        <div class="col-md-4">
                                            <mat-label>Invoice Amount</mat-label>
                                            <br>
                                            <mat-label> {{paymentInfo?.invoiceAmount == null ? 'R 0' : 'R ' +
                                                paymentInfo?.invoiceAmount}}</mat-label>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-label>Due Date</mat-label>
                                            <br>
                                            <mat-label>{{paymentInfo?.invoiceDueDate != null ?
                                                (paymentInfo?.invoiceDueDate
                                                | date: 'dd-MMM-yyyy') : ''}}</mat-label>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-icon (click)="downloadInvoice()" class="attach"
                                                style=" font-size: 25px;cursor: pointer;">attach_file
                                            </mat-icon>
                                            <mat-label style="margin-left: 7px; margin-bottom: 5px;">Download Invoice
                                            </mat-label>


                                        </div>
                                    </div>

                                    <div class="row mx-0" style="margin-top: 10px;">
                                        <div class="col-4">
                                            <!-- <mat-form-field appearance="outline" class="input-margin">
                                                <mat-label>Other Documents</mat-label>
                                                <mat-select [(ngModel)]="documentTypeIdSelected"
                                                    formControlName="documentTypeId" matInput>
                                                    <mat-option [value]="133" selected>
                                                        POP
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field> -->
                                            <mat-form-field appearance="outline" class="mt-2">
                                                <mat-label>Choose File</mat-label>
                                                <input [value]="uploadedPaymentFileName" disabled matInput />
                                                <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                                    <mat-icon class="attach">attach_file</mat-icon>
                                                </button>
                                                <input #fileInput (change)="selectPaymentFile($event)" hidden
                                                    id="newFile" type="file" formControlName="file" required>
                                                <!-- <p>{{docName}}</p> -->
                                            </mat-form-field>
                                            <small
                                                *ngIf="uploadpaymentform.controls['file'].hasError('required') && uploadpaymentform.controls['file'].touched"
                                                class="text-danger support-text">File Required.</small>

                                            <mat-form-field appearance="outline" class="input-margin mt-2">
                                                <mat-label>Payment Date</mat-label>
                                                <input [matDatepicker]="dp3" [max]="maxDate"
                                                    formControlName="paymentDate" matInput required />
                                                <mat-datepicker-toggle [for]="dp3" matSuffix></mat-datepicker-toggle>
                                                <mat-datepicker #dp3 disabled="false"></mat-datepicker>
                                            </mat-form-field>
                                            <small
                                                *ngIf="uploadpaymentform.controls['paymentDate'].hasError('required') && uploadpaymentform.controls['paymentDate'].touched"
                                                class="text-danger support-text">Payment Date Required.</small>

                                            <mat-form-field appearance="outline" class="input-margin mt-2">
                                                <mat-label>Paid Amount</mat-label>
                                                <input formControlName="paidAmount" matInput required />
                                            </mat-form-field>
                                            <small
                                                *ngIf="uploadpaymentform.controls['paidAmount'].hasError('required') && uploadpaymentform.controls['paidAmount'].touched"
                                                class="text-danger support-text">Paid Amount Required.</small>
                                            <br>
                                            <small
                                                *ngIf="uploadpaymentform.controls['paidAmount'].hasError('pattern') && uploadpaymentform.controls['paidAmount'].touched"
                                                class="text-danger support-text">Paid Amount must be numeric with 2
                                                decimal point</small>

                                            <mat-form-field appearance="outline" class="input-margin mt-2">
                                                <mat-label>Referrence Number</mat-label>
                                                <input formControlName="paymentReferenceNo" matInput required />
                                            </mat-form-field>
                                            <small
                                                *ngIf="uploadpaymentform.controls['paymentReferenceNo'].hasError('required') && uploadpaymentform.controls['paymentReferenceNo'].touched"
                                                class="text-danger support-text">Payment Reference No. Required.</small>

                                            <mat-form-field appearance="outline" class="input-margin mt-2">
                                                <mat-label>Notes</mat-label>
                                                <textarea formControlName="comments" matInput rows="4"
                                                    style="color: black;" #payComment required></textarea>
                                                <span class="pull-right char" style="color: black;"><em>{{ 1000 -
                                                        payComment?.value?.length }} characters left</em></span>
                                            </mat-form-field>
                                            <small
                                                *ngIf="uploadpaymentform.controls['comments'].hasError('required') && uploadpaymentform.controls['comments'].touched"
                                                class="text-danger support-text">Comments Required.</small>
                                            <!-- <mat-radio-button (change)="onProcessChange2($event)" [value]="true"
                                                class="radio-button">Process
                                            </mat-radio-button> -->

                                        </div>
                                    </div>
                                    <div class="row mx-0 absolute absoluteNew">
                                        <div class="col p-0">
                                            <div>
                                                <button mat-raised-button (click)="uploadProofOfPayment()"
                                                    class="submit-button submit float-right">Submit
                                                </button>
                                                <!-- <button mat-raised-button (click)="close()"
                                                    class="back-button cancel float-right">Cancel
                                                </button> -->
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>


                        <div *ngIf="activeTabId == 2" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <div *ngIf="nodeDetails.FormID == 4">
                                <p class="sub-heading">{{nodeDetails.formName}}</p>

                                <form [formGroup]="confirmPaymentform" style="margin-top: 10px;">
                                    <div class="row  mx-0">
                                        <div class="col-md-4">
                                            <mat-label>Invoice Amount</mat-label>
                                            <br>
                                            <mat-label> {{paymentInfo?.invoiceAmount == null ? 'R 0' : 'R ' +
                                                paymentInfo?.invoiceAmount}}</mat-label>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-label>Due Date</mat-label>
                                            <br>
                                            <mat-label>{{paymentInfo?.invoiceDueDate != null ?
                                                (paymentInfo?.invoiceDueDate
                                                | date: 'dd-MMM-yyyy') : ''}}</mat-label>
                                        </div>
                                        <div class="col-md-4">
                                            <mat-icon (click)="downloadInvoice()" class="attach"
                                                style=" font-size: 25px;cursor: pointer;">attach_file
                                            </mat-icon>
                                            <mat-label style="margin-left: 7px; margin-bottom: 5px;">Download Invoice
                                            </mat-label>


                                        </div>
                                    </div>

                                    <div class="row mx-0" style="margin-top: 10px;">
                                        <div class="col-4">

                                            <div style="margin-top: 20px;">
                                                <mat-icon (click)="downloadPOP()" class="attach"
                                                    style=" font-size: 20px;cursor: pointer;">attach_file
                                                </mat-icon>
                                                <mat-label style="margin-left: 7px;">View POP</mat-label>
                                            </div>
                                            <div class="text-muted" style="margin-top: 5px;">
                                                <mat-label>Payment Date
                                                    : {{paymentInfo?.paymentDate != null ? (paymentInfo?.paymentDate |
                                                    date:
                                                    'dd-MMM-yyyy') : ''}}</mat-label>
                                            </div>
                                            <div class="text-muted" style="margin-top: 5px;">
                                                <mat-label>Paid Amount : {{paymentInfo?.paidAmount}}</mat-label>
                                            </div>
                                            <div class="text-muted" style="margin-top: 5px;">
                                                <mat-label>Referrence Number
                                                    : {{paymentInfo?.paymentReferenceNo}}</mat-label>
                                            </div>
                                            <!-- <div style="margin-top: 5px;">
                                                <section class="radio-section">
                                                    <mat-checkbox [(ngModel)]="checked"
                                                        [ngModelOptions]="{standalone: true}" class="radio-margin">
                                                        Payment
                                                        Verified
                                                    </mat-checkbox>
                                                </section>
                                            </div>

                                            <mat-form-field appearance="outline" class="input-margin mt-2">
                                                <mat-label>Notes</mat-label>
                                                <textarea formControlName="Notes" matInput rows="4"
                                                    style="color: black;" #popNote></textarea>
                                                <span class="pull-right char" style="color: black;"><em>{{ 1000 -
                                                        popNote?.value?.length }} characters left</em></span>
                                            </mat-form-field> -->


                                        </div>
                                    </div>

                                    <!-- <div class="row mx-0 absolute absoluteNew">
                                        <div class="col p-0">
                                            <div>
                                                <button mat-raised-button
                                                    class="submit-button submit float-right">Submit
                                                </button>
                                                <button mat-raised-button (click)="close()"
                                                    class="back-button cancel float-right">Cancel
                                                </button>
                                            </div>
                                        </div>
                                    </div> -->
                                </form>
                            </div>
                        </div>

                        <div *ngIf="activeTabId == 2" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <div *ngIf="taskDetail.processName == 'Query'">
                                <p class="sub-heading">{{nodeDetails.formName}}</p>
                                <div class="row mx-0">
                                    <div class="col-8">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Issue Type</mat-label>
                                            <input [(ngModel)]="issueType" matInput readonly />
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Description</mat-label>
                                            <input [(ngModel)]="queryDescription" matInput readonly />
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div *ngIf="activeTabId == 2" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <div *ngIf="nodeDetails.FormID == 3">
                                <p class="sub-heading" style="color:green" *ngIf="paymentInfo !== null">
                                    {{(paymentInfo?.invoiceAmount != null && paymentInfo?.invoiceAmount > 0 ? 'Invoice
                                    Generated' : '')}}
                                </p>
                                <hr>
                                <div *ngFor="let item of ItemData;let j = index">
                                    <div class="row" style="display: flex;margin-top:20px">
                                        <div class="col-3 pr-1"
                                            *ngIf="item.searchDetails != undefined && item.templateListItemId !== 567">
                                            <div class="gallery-wrapper" style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                        -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                        border-color: rgba(0,0,0,.2);">
                                                <ngx-skeleton-loader *ngIf="showImageLoader" count="5"
                                                    appearance="circle" [theme]="{
                                            width: '70px',
                                            height: '70px',
                                            'border-radius': '10px'
                                          }"></ngx-skeleton-loader>
                                                <ngx-gallery *ngIf="!showImageLoader" #gallery1
                                                    [options]="galleryOptions" [images]="item.searchDetails.imageArray"
                                                    class="ngx-gallery">
                                                </ngx-gallery>
                                            </div>
                                            <span class="row justify-content-center mt-3">
                                                <button mat-raised-button class="yellow-button bmapover"
                                                    (click)="openViewMapDialog(item.searchDetails)">View Map</button>
                                                <button mat-raised-button (click)="navigate(item)"
                                                    class="yellow-button bmapover">View
                                                    Profile</button>
                                            </span>
                                        </div>
                                        <div class="col-3 pr-1"
                                            *ngIf="item.searchDetails != undefined && item.templateListItemId === 567">
                                            <div class="gallery-wrapper"
                                                style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                border-color: rgba(0,0,0,.2);height: 380px;width: 230px;">
                                                <span fxLayoutAlign="center center">No Preview available</span>

                                            </div>
                                        </div>
                                        <div class="col-9" *ngIf="item.searchDetails != undefined">
                                            <div class="row" *ngIf="item.templateListItemId !== 567">
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Region</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.region !== undefined ?
                                                                item.searchDetails.region :
                                                                item.searchDetails.minorRegion :
                                                                ''}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel Type</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.parcelType : ''}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel</p>
                                                            <p class="desc-text mt-0">{{(item.searchDetails.parcel !=
                                                                null
                                                                &&
                                                                item.searchDetails.parcel != undefined) ?
                                                                item.searchDetails.parcel :
                                                                (item.searchDetails.erfNumber != null &&
                                                                item.searchDetails.erfNumber != undefined ?
                                                                item.searchDetails.erfNumber :
                                                                (item.searchDetails.farmNumber !=
                                                                null && item.searchDetails.farmNumber != undefined ?
                                                                item.searchDetails.farmNumber :
                                                                item.searchDetails.holdingNumber))}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Province</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.province}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">SG Number</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.sgNo}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">File Size (KB)</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails.totalFileSize}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Total Pages</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.totalPages}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">LPI</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.lpi}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Municipality</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.localMunicipalityName}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Portion</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails?.portion}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentType}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Sub Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentSubType}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box"
                                                    *ngIf="item.searchDetails.filterName != undefined">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">{{item.searchDetails?.filterName}}
                                                            </p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.searchNumber}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="row" *ngIf="item.templateListItemId === 567">
                                                <div class="row">
                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="row">
                                                            <span class="col">
                                                                <span class="info-text">Category</span>
                                                                <br>
                                                                <span
                                                                    class="desc-text">{{item.searchDetails?.categoryName}}</span>
                                                            </span>
                                                            <span class="col">
                                                                <span class="info-text">Subcategory</span>
                                                                <br>
                                                                <span
                                                                    class="desc-text">{{item.searchDetails?.name}}</span>
                                                            </span>
                                                        </span>
                                                    </div>

                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="row">
                                                            <span class="col">
                                                                <span class="desc-text"><b>Description</b></span>
                                                                <br>
                                                                <span
                                                                    class="info-text">{{item.searchDetails?.description}}</span>
                                                            </span>
                                                        </span>
                                                    </div>

                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="desc-text"><b>Information Type</b></span>

                                                        <span class="row info-text">
                                                            <div class="col-12 col-md-6">
                                                                <!-- <mat-checkbox [checked]='true' [disableRipple]="true"
                                                                    (click)="$event.preventDefault()"> -->
                                                                <span>{{item.searchDetails?.categoryName}}<b>{{searchDetails?.name}}</b></span>
                                                                <!-- </mat-checkbox> -->
                                                            </div>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-top: 43px;">
                                                <div class="col">
                                                    <table [dataSource]="item.cartInvoiceItems" class="w-100" mat-table>
                                                        <ng-container matColumnDef="sno">
                                                            <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                            <td *matCellDef="let element" mat-cell>{{element.sno}}</td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="Item">
                                                            <th *matHeaderCellDef mat-header-cell>Item</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{element.item}}</td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="type">
                                                            <th *matHeaderCellDef mat-header-cell>Type</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{
                                                                element?.item == 130 || element?.item ==
                                                                127 ?
                                                                '' :
                                                                (element?.item == 126 || element?.item ==
                                                                129
                                                                || element?.item == 125)
                                                                ? element.type : element.type

                                                                }}</td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="details">
                                                            <th *matHeaderCellDef mat-header-cell>Details</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{
                                                                element?.details
                                                                }}
                                                                <!-- {{element?.Item == 129 ? element.certType?.caption : ''}} -->
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="estimate">
                                                            <th *matHeaderCellDef mat-header-cell>System Estimate (R)
                                                            </th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{element.systemEstimate}}
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="time">
                                                            <th *matHeaderCellDef mat-header-cell>Time Required</th>
                                                            <td *matCellDef="let element; let index = index" mat-cell>
                                                                <input
                                                                    (change)="UpdatedItem(element.timeRequired,'time',index,j)"
                                                                    [(ngModel)]="element.timeRequired"
                                                                    style="height: 80%; width: 70%; border-radius: 4px;"
                                                                    type="text" value="element.timeRequired">

                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="comment">
                                                            <th *matHeaderCellDef mat-header-cell>Comments</th>
                                                            <td *matCellDef="let element; let index = index" mat-cell>
                                                                <textarea
                                                                    (change)="UpdatedItem(element.comments,'comments',index,j)"
                                                                    [(ngModel)]="element.comments" rows="1"
                                                                    class="autogrow"
                                                                    style="width: 70%; border-radius: 4px;color: black;"
                                                                    value="element.comments"></textarea>
                                                                <!-- <span class="pull-right char" style="color: black;"><em>{{ 1000 - element.comments?.length }} characters left</em></span> -->
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="finalCost">
                                                            <th *matHeaderCellDef mat-header-cell>Final Cost (R)</th>
                                                            <td *matCellDef="let element; let index = index" mat-cell>
                                                                <input
                                                                    (change)="UpdatedItem(element.finalCost,'finalCost',index,j)"
                                                                    [(ngModel)]="element.finalCost"
                                                                    style="height: 80%; width: 90%; border-radius: 4px;"
                                                                    type="number" value="element.finalCost">
                                                            </td>
                                                        </ng-container>
                                                        <tr *matHeaderRowDef="columns" mat-header-row></tr>
                                                        <tr *matRowDef="let row; columns: columns;" mat-row></tr>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="row" *ngIf="item.templateListItemId === 567">
                                                <div class="col">
                                                    <span class="desc-text"><b>Notes</b>
                                                    </span>
                                                    <br>
                                                    <div class="row f-css">
                                                        <mat-form-field appearance="outline">
                                                            <!-- <mat-label>Notes</mat-label> -->
                                                            <textarea [(ngModel)]="item.cartInvoiceItems[0].notes"
                                                                matInput style="color: black;" disabled></textarea>
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <!-- <div class="col-12 col-md-12 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <span class="desc-text"><b>Notes</b></span>
                                                            <br>
                                                            <div class="row f-css">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Notes</mat-label>
                                                                    <textarea [(ngModel)]="item.cartData.ngiData.notes"
                                                                        matInput style="color: black;" disabled></textarea>
                                                                </mat-form-field>
                                                            </div>
                                                        </span>
                                                    </span>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-2">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Delivery Method</mat-label>
                                            <mat-select (selectionChange)="deliveryMethodChange($event.value)"
                                                [(ngModel)]="selectedMode">
                                                <mat-option *ngFor="let x of selectedModes" [value]="x">{{x.caption}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <input (change)="calculate()" [(ngModel)]="deliveryMethodPrice"
                                            class="float-right" placeholder="0 ZAR" style="border-radius: 4px;"
                                            type="number" value="0">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-2">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Delivery Medium</mat-label>
                                            <mat-select (selectionChange)="deliveryMediumChange($event.value)"
                                                [(ngModel)]="deliveryMedia">
                                                <mat-option *ngFor="let x of deliveryMediasdata" [value]="x"
                                                    class="r-margin">{{x.caption}}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-2" *ngIf="selectedMode?.caption !== 'ELECTRONIC'">
                                        <mat-form-field appearance="outline">
                                            <mat-label>No of DVDs</mat-label>
                                            <input (change)="calculate()" [(ngModel)]="noOfCD" matInput type="number" />
                                        </mat-form-field>
                                    </div>
                                    <div class="col-3" *ngIf="selectedMode?.caption !== 'ELECTRONIC'">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Notes to Add:</mat-label>
                                            <textarea [(ngModel)]="notes" matInput
                                                placeholder="Please pay before 1st Jan."
                                                style="color: black;"></textarea>
                                            <span class="pull-right char" style="color: black;"><em>{{ 1000 -
                                                    notes?.length
                                                    }} characters left</em></span>
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <input (change)="calculatePrice()" [(ngModel)]="deliveryModePrice"
                                            class="float-right" placeholder="0 ZAR" style="border-radius: 4px;"
                                            type="number" value="0">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col gray-box" style="height: 50px;">
                                        <div class="float-left">
                                            <span (click)="previewEmail()" class="desc-text"
                                                style="text-decoration: underline; color: #016533; cursor: pointer;">Preview
                                                Email</span>
                                        </div>
                                        <div class="float-right py-3">
                                            Total Cost:<strong> {{total}} ZAR </strong>
                                            <a (click)="saveInvoiceData(true,'view')" [disabled]="paymentInfo !== null"
                                                class="desc-text"
                                                style="text-decoration: underline; color: #016533; cursor: pointer;">View
                                                Invoice</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="row my-3">
                                    <div class="col">
                                        <span class="float-right" *ngIf="paymentInfo === null">
                                            <button mat-raised-button (click)="saveInvoiceData(true,'save')"
                                                [disabled]="paymentInfo !== null" class="submit-button bover"
                                                style="height: 44px; margin-right: 5px;">Save</button>

                                            <button mat-raised-button (click)="saveInvoiceData(true,'submit')"
                                                [disabled]="paymentInfo !== null" class="submit-button bover"
                                                style="height: 44px; margin-right: 5px;">{{paymentInfo !== null ?
                                                (paymentInfo.invoiceAmount != null && paymentInfo.invoiceAmount > 0 ?
                                                'Invoice Generated' : 'Submit') : 'Submit'}}</button>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="nodeDetails.FormID == 5">
                                <hr>
                                <div *ngFor="let item of DispatchItemData;let j = index">
                                    <div class="row" style="display: flex;margin-top:20px">
                                        <div class="col-3 pr-1"
                                            *ngIf="item.searchDetails != undefined && item.templateListItemId !== 567">
                                            <!-- <img [src]="item.searchDetails.tempPreview?.preview" alt="" class="main-image"
                                            matTooltip="{{item.searchDetails.tempPreview?.scandate | date : 'dd/MMMM/y HH:mm:ss' }}"> -->
                                            <div class="gallery-wrapper" style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                        -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                        border-color: rgba(0,0,0,.2);">
                                                <ngx-skeleton-loader *ngIf="showImageLoader" count="5"
                                                    appearance="circle" [theme]="{
                                            width: '70px',
                                            height: '70px',
                                            'border-radius': '10px'
                                          }"></ngx-skeleton-loader>
                                                <ngx-gallery *ngIf="!showImageLoader" #gallery2
                                                    [options]="galleryOptions" [images]="item.searchDetails.imageArray"
                                                    class="ngx-gallery">
                                                </ngx-gallery>
                                            </div>
                                            <span class="row justify-content-center mt-3">
                                                <button mat-raised-button class="yellow-button bmapover"
                                                    (click)="openViewMapDialog(item.searchDetails)">View Map</button>
                                                <button mat-raised-button (click)="navigate(item)"
                                                    class="yellow-button bmapover">View
                                                    Profile</button>
                                            </span>
                                            <!-- <div class="row" style="margin-top: 16px;">
                                            <div *ngFor="let img of item.searchDetails.imageArray" class="col-3 pr-1">
                                                <img (click)="selectImage($event)"
                                                    [ngClass]="item.searchDetails.tempPreview.preview === img.preview ? 'selected-image' : 'bottom-image'"
                                                    [src]="img.thumbnail" alt="" id="{{img.preview}}">
                                            </div>
                                        </div> -->
                                        </div>
                                        <div class="col-3 pr-1"
                                            *ngIf="item.searchDetails != undefined && item.templateListItemId === 567">
                                            <div class="gallery-wrapper"
                                                style="box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                -webkit-box-shadow: 0 2px 10px rgb(0 0 0 / 20%);
                                                                border-color: rgba(0,0,0,.2);height: 380px;width: 230px;">
                                                <span fxLayoutAlign="center center">No Preview available</span>

                                            </div>
                                        </div>
                                        <div class="col-9" *ngIf="item.searchDetails != undefined">
                                            <div class="row" *ngIf="item.templateListItemId !== 567">
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Region</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.region !== undefined ?
                                                                item.searchDetails.region :
                                                                item.searchDetails.minorRegion :
                                                                ''}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel Type</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails ?
                                                                item.searchDetails.parcelType : ''}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Parcel</p>
                                                            <p class="desc-text mt-0">{{(item.searchDetails.parcel !=
                                                                null
                                                                &&
                                                                item.searchDetails.parcel != undefined) ?
                                                                item.searchDetails.parcel :
                                                                (item.searchDetails.erfNumber != null &&
                                                                item.searchDetails.erfNumber != undefined ?
                                                                item.searchDetails.erfNumber :
                                                                (item.searchDetails.farmNumber !=
                                                                null && item.searchDetails.farmNumber != undefined ?
                                                                item.searchDetails.farmNumber :
                                                                item.searchDetails.holdingNumber))}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Province</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.province}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">SG Number</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.sgNo}}</p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">File Size (KB)</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails.totalFileSize}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Total Pages</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.totalPages}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">LPI</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails.lpi}}</p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Municipality</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.localMunicipalityName}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Portion</p>
                                                            <p class="desc-text mt-0">{{item.searchDetails?.portion}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentType}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                            <p class="info-text mb-0">Document Sub Type</p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.documentSubType}}
                                                            </p>
                                                        </span>
                                                    </span>
                                                </div>
                                                <div class="col-12 col-md-6 gray-box"
                                                    *ngIf="item.searchDetails.filterName != undefined">
                                                    <span class="row">
                                                        <span class="col">
                                                            <p class="info-text mb-0">{{item.searchDetails?.filterName}}
                                                            </p>
                                                            <p class="desc-text mt-0">
                                                                {{item.searchDetails?.searchNumber}}
                                                            </p>
                                                        </span>
                                                        <span class="col">
                                                        </span>
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="row" *ngIf="item.templateListItemId === 567">
                                                <div class="row">
                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="row">
                                                            <span class="col">
                                                                <span class="info-text">Category</span>
                                                                <br>
                                                                <span
                                                                    class="desc-text">{{item.searchDetails?.categoryName}}</span>
                                                            </span>
                                                            <span class="col">
                                                                <span class="info-text">Subcategory</span>
                                                                <br>
                                                                <span
                                                                    class="desc-text">{{item.searchDetails?.name}}</span>
                                                            </span>
                                                        </span>
                                                    </div>

                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="row">
                                                            <span class="col">
                                                                <span class="desc-text"><b>Description</b></span>
                                                                <br>
                                                                <span
                                                                    class="info-text">{{item.searchDetails?.description}}</span>
                                                            </span>
                                                        </span>
                                                    </div>

                                                    <div class="col-12 col-md-12 gray-box">
                                                        <span class="desc-text"><b>Information Type</b></span>

                                                        <span class="row info-text">
                                                            <div class="col-12 col-md-6">
                                                                <!-- <mat-checkbox [checked]='true' [disableRipple]="true"
                                                                    (click)="$event.preventDefault()"> -->
                                                                <span>{{item.searchDetails?.categoryName}}<b>{{searchDetails?.name}}</b></span>
                                                                <!-- </mat-checkbox> -->
                                                            </div>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" style="margin-top: 43px;">
                                                <div class="col">
                                                    <table [dataSource]="item.cartDispatchItems" class="w-100"
                                                        mat-table>
                                                        <ng-container matColumnDef="sno">
                                                            <th *matHeaderCellDef mat-header-cell>Sno.</th>
                                                            <td *matCellDef="let element" mat-cell>{{element.sno}}</td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="Item">
                                                            <th *matHeaderCellDef mat-header-cell>Item</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{element.item}}</td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="type">
                                                            <th *matHeaderCellDef mat-header-cell>Type</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{
                                                                element?.item == 130 || element?.item ==
                                                                127 ?
                                                                '' :
                                                                (element?.item == 126 || element?.item ==
                                                                129
                                                                || element?.item == 125)
                                                                ? element.type : element.type

                                                                }}</td>
                                                        </ng-container>
                                                        <!-- <ng-container matColumnDef="type"
                                                        *ngIf="element?.Item == 130 || element?.Item == 127>
                                                        <th mat-header-cell *matHeaderCellDef>Type</th>
                                                        <td mat-cell *matCellDef="let element">
                                                            {{element.type?.caption}}</td>
                                                    </ng-container> -->
                                                        <ng-container matColumnDef="details">
                                                            <th *matHeaderCellDef mat-header-cell>Details</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{
                                                                element?.details
                                                                }}
                                                                <!-- {{element?.Item == 129 ? element.certType?.caption : ''}} -->
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="time">
                                                            <th *matHeaderCellDef mat-header-cell>Time Required</th>
                                                            <td *matCellDef="let element" mat-cell>
                                                                {{element.timeRequired}}</td>
                                                        </ng-container>

                                                        <ng-container matColumnDef="comment">
                                                            <th *matHeaderCellDef mat-header-cell>Comments</th>
                                                            <td *matCellDef="let element; let index = index" mat-cell>
                                                                <textarea
                                                                    (change)="UpdatedDispatchItem(element.comments,'comment',index,j)"
                                                                    [(ngModel)]="element.comments" rows="1"
                                                                    style="border-radius: 4px; color: black;"
                                                                    class="autogrow"
                                                                    value="element.comments"></textarea>
                                                                <!-- <span class="pull-right char" style="color: black;"><em>{{ 1000 - comment?.length }} characters left</em></span> -->
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="prepared">
                                                            <th *matHeaderCellDef mat-header-cell>Prepared</th>
                                                            <td *matCellDef="let element; let index = index" mat-cell>
                                                                <mat-slide-toggle
                                                                    (change)="UpdatedDispatchItem($event.checked,'dispatchStatus',index,j)"
                                                                    [(ngModel)]="element.dispatchStatus"
                                                                    ngDefaultControl value="element.dispatchStatus">
                                                                </mat-slide-toggle>
                                                            </td>
                                                        </ng-container>
                                                        <ng-container matColumnDef="View">
                                                            <th *matHeaderCellDef mat-header-cell>View</th>
                                                            <td *matCellDef="let element" mat-cell><a
                                                                    style="cursor: pointer;"
                                                                    (click)="viewdispatch(element)">View</a></td>
                                                        </ng-container>
                                                        <tr *matHeaderRowDef="dispatchcolumns" mat-header-row></tr>
                                                        <tr *matRowDef="let row; columns: dispatchcolumns;" mat-row>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="row" *ngIf="item.templateListItemId === 567">
                                                <div class="col">
                                                    <span class="desc-text"><b>Notes</b>
                                                    </span>
                                                    <br>
                                                    <div class="row f-css">
                                                        <mat-form-field appearance="outline">
                                                            <!-- <mat-label>Notes</mat-label> -->
                                                            <textarea [(ngModel)]="item.cartDispatchItems[0].notes"
                                                                matInput style="color: black;" disabled></textarea>
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <hr>

                                <div class="row">

                                    <div class="col-4">
                                        <!-- <mat-label>Dispatch Method</mat-label>
                                        <mat-form-field appearance="outline">
                                            <input matInput [(ngModel)]="dispatchMethodName" readonly type="text" />
                                        </mat-form-field> -->
                                        <mat-form-field appearance="outline">
                                            <mat-label>Dispatch Method</mat-label>
                                            <mat-select (selectionChange)="dispatchDeliveryMethodChange($event.value)"
                                                [(ngModel)]="dispatchMethodName">
                                                <mat-option *ngFor="let x of selectedModes" [value]="x.caption">
                                                    {{x.caption}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Dispatch Medium</mat-label>
                                            <mat-select [(ngModel)]="dispatchMedia">
                                                <mat-option *ngFor="let x of deliveryMediasdata" [value]="x.caption"
                                                    class="r-margin">{{x.caption}}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-4" style="margin-top: 8px;">
                                        <a mat-raised-button class="float-right" style="color:blue; cursor: pointer;"
                                            (click)="dispatchdoc()">Dispatch
                                            Documents Summary</a>
                                    </div>
                                </div>
                                <form [formGroup]="dispatchMethod">

                                    <div class="row">

                                        <div class="col-4">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Reference Number</mat-label>
                                                <input formControlName="referenceNumber" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMedia == 'EMAIL'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Primary Email</mat-label>
                                                <input formControlName="primaryEmail" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMedia == 'EMAIL'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Secondary Email</mat-label>
                                                <input formControlName="secondaryEmail" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4"
                                            *ngIf="dispatchMethodName == 'COLLECTION' || dispatchMethodName == 'COURIER'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Data Dispatched</mat-label>
                                                <input formControlName="dataDispatched" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'COLLECTION'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Collector Name</mat-label>
                                                <input formControlName="collectorName" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'COLLECTION'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Collector Surname</mat-label>
                                                <input formControlName="collectorSurname" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'COLLECTION'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Collector Contact Number</mat-label>
                                                <input formControlName="collectorContactNumber" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'POST'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Postal AddressLine 1</mat-label>
                                                <input formControlName="postaladdressLine1" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'POST'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Postal AddressLine 2</mat-label>
                                                <input formControlName="postaladdressLine2" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'POST'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Postal AddressLine 3</mat-label>
                                                <input formControlName="postaladdressLine3" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'POST'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Postal Code</mat-label>
                                                <input formControlName="postalCode" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'COURIER'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Courier Name</mat-label>
                                                <input formControlName="courierName" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMethodName == 'COURIER'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Contact Person</mat-label>
                                                <input formControlName="contactPerson" matInput type="text" />
                                            </mat-form-field>
                                        </div>

                                        <div class="col-4" *ngIf="dispatchMedia == 'FTP'">
                                            <mat-form-field appearance="outline">
                                                <mat-label>FTP Details</mat-label>
                                                <input formControlName="ftpDetails" matInput type="text" />
                                            </mat-form-field>
                                        </div>


                                    </div>
                                </form>
                                <div class="row">
                                    <div class="col-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Dispatch Reference Number</mat-label>
                                            <input [(ngModel)]="dispatchRefNo" matInput type="text" />
                                        </mat-form-field>
                                    </div>
                                    <div class="col-4">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Dispatch date</mat-label>
                                            <input [(ngModel)]="dispatchDate" [(ngModel)]="dispatchDate"
                                                [matDatepicker]="picker1" [min]="minDate" matInput />
                                            <mat-datepicker-toggle [for]="picker1" matSuffix></mat-datepicker-toggle>
                                            <mat-datepicker #picker1></mat-datepicker>
                                        </mat-form-field>
                                    </div>

                                </div>
                                <div class="row my-3">
                                    <div class="col">
                                        <span class="float-right">
                                            <button mat-raised-button (click)="saveDispatchData()"
                                                class="submit-button bover"
                                                style="height: 44px; margin-right: 5px;">Save</button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div *ngIf="activeTabId == 3" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Request Flow</p>
                            <div class="row mx-0 w-75 justify-content-between">
                                <p class="text">Request Code: <span class="color">{{taskDetail.referenceNo}}</span></p>
                                <p class="text">Task Open Date: <span class="color">{{taskDetail.triggeredOn
                                        |date:"dd/MMM/yyyy"}}</span></p>
                                <p class="text">Task Code: <span class="color">{{taskDetail.actionId}}</span></p>
                            </div>
                            <div class="row mx-0">
                                <div class="col-10 p-0">
                                    <div>
                                        <table [dataSource]="flowDataSource" class="table-margin w-100 m-0" mat-table>
                                            <ng-container matColumnDef="date">
                                                <th *matHeaderCellDef mat-header-cell>Date</th>
                                                <td *matCellDef="let element" mat-cell>{{element.postedOn
                                                    |date:"dd/MMM/yyyy"}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="user">
                                                <th *matHeaderCellDef mat-header-cell>User</th>
                                                <td *matCellDef="let element" mat-cell>{{element.actionTakenBy}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="action">
                                                <th *matHeaderCellDef mat-header-cell>Action</th>
                                                <td *matCellDef="let element" mat-cell>{{element.actionReq}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="duration">
                                                <th *matHeaderCellDef mat-header-cell>Duration</th>
                                                <td *matCellDef="let element" mat-cell>{{element.postedOn |
                                                    dateDifference:end}}
                                                </td>
                                            </ng-container>
                                            <ng-container matColumnDef="note">
                                                <th *matHeaderCellDef mat-header-cell>Notes</th>
                                                <td *matCellDef="let element" mat-cell>{{element.note}}
                                                </td>
                                            </ng-container>
                                            <tr *matHeaderRowDef="flowColumns" mat-header-row></tr>
                                            <tr *matRowDef="let row; columns: flowColumns;" mat-row></tr>
                                        </table>
                                        <div>
                                            <mat-paginator #paginator [length]="flowDataLength"
                                                [pageSizeOptions]="[5, 10, 20]" [pageSize]="5" showFirstLastButtons>
                                            </mat-paginator>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <a style="cursor: pointer; color: blue;" (click)="viewReferral()">View Details Task
                                    Duration</a>
                            </div>
                            <!-- <div class="row mx-0 absolute absoluteNew">
                                <div class="col p-0">
                                    <div>
                                        <button class="submit-button btn1 submit float-right">Submit</button>
                                        <button class="back-button btn1 cancel float-right"
                                            (click)="close()">Cancel</button>
                                    </div>
                                </div>
                            </div> -->
                        </div>

                        <div *ngIf="activeTabId == 4" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Supporting Documents</p>
                            <div class="row mx-0">
                                <div class="col-8">
                                    <mat-form-field *ngFor="let document of supportingDocuments" appearance="outline">
                                        <mat-label>{{document.documentName}}</mat-label>
                                        <input disabled matInput />
                                        <!-- <button mat-icon-button matSuffix (click)="fileInput.click()">
                                    <mat-icon class="attach">attach_file</mat-icon>
                                </button> -->
                                        <button (click)="downloaddoc(document)" mat-icon-button matSuffix>
                                            <mat-icon class="delete">get_app</mat-icon>
                                        </button>
                                        <button (click)="deleteDoc(document)" mat-icon-button matSuffix>
                                            <mat-icon class="delete">delete</mat-icon>
                                        </button>
                                        <button mat-icon-button matSuffix
                                            matTooltip="Document Type:{{document.documentType}}  Size:{{document.sizeKb}} (KB) notes:{{document.notes}} Uploaded By:{{document.uploadedBy}} Uploaded On:{{document.uploadedOn | date : 'dd/MMMM/y HH:mm:ss'}}">
                                            <mat-icon aria-label="Button that shows a red tooltip" class="t-button"
                                                style="cursor: pointer;">
                                                error_outline
                                            </mat-icon>
                                        </button>
                                        <input #fileInput (change)="selectFile($event)" hidden id="file" type="file">
                                    </mat-form-field>
                                    <!-- <mat-form-field appearance="outline">
                                <mat-label>Attach Request Document</mat-label>
                                <input matInput disabled>
                                <button mat-icon-button matSuffix (click)="fileInput.click()">
                                    <mat-icon class="attach">attach_file</mat-icon>
                                </button>
                                <input hidden (change)="selectFile($event)" #fileInput type="file" id="file">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Payment Confirmation</mat-label>
                                <input matInput disabled>
                                <button mat-icon-button matSuffix (click)="fileInput.click()">
                                    <mat-icon class="attach">attach_file</mat-icon>
                                </button>
                                <input hidden (change)="selectFile($event)" #fileInput type="file" id="file">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Invoice</mat-label>
                                <input matInput disabled>
                                <button mat-icon-button matSuffix (click)="fileInput.click()">
                                    <mat-icon class="attach">attach_file</mat-icon>
                                </button>
                                <input hidden (change)="selectFile($event)" #fileInput type="file" id="file">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Attach More Documents</mat-label>
                                <input matInput disabled>
                                <button mat-icon-button matSuffix (click)="fileInput.click()">
                                    <mat-icon class="attach">attach_file</mat-icon>
                                </button>
                                <input hidden (change)="selectFile($event)" #fileInput type="file" id="file">
                            </mat-form-field> -->
                                </div>
                            </div>
                            <form [formGroup]="uploadDocForm">
                                <div class="row mx-0">
                                    <div class="col-3">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Other Documents</mat-label>
                                            <mat-select formControlName="documentType" matInput>
                                                <mat-option *ngFor="let listItem of listItems"
                                                    [value]="listItem.itemId">
                                                    {{listItem.caption}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="mt-2">
                                            <mat-label>Choose File</mat-label>
                                            <input disabled matInput />
                                            <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                                <mat-icon class="attach">attach_file</mat-icon>
                                            </button>
                                            <input #fileInput (change)="selectFile($event.target.files)" hidden
                                                id="newFile" type="file">
                                            <p>{{docName}}</p>
                                        </mat-form-field>


                                        <mat-form-field appearance="outline" class="input-margin mt-2">
                                            <mat-label>Comment</mat-label>
                                            <textarea formControlName="comment" matInput style="color: black;"
                                                #supportingDocComment></textarea>
                                            <span class="pull-right char" style="color: black;"><em>{{ 1000 -
                                                    supportingDocComment?.value?.length }} characters left</em></span>
                                        </mat-form-field>

                                    </div>
                                </div>
                                <div class="row mx-0 absolute absoluteNew">
                                    <div class="col p-0">
                                        <div>
                                            <button mat-raised-button (click)="submitDoc()"
                                                class="submit-button submit bhover float-right">Submit
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div *ngIf="activeTabId == 5" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Referral Inputs</p>
                            <div class="row mx-0">
                                <div class="col-12 p-0">
                                    <div>
                                        <table [dataSource]="refData" class="table-margin w-100 m-0" mat-table>
                                            <ng-container matColumnDef="referenceNo">
                                                <th style="width: 10%;" *matHeaderCellDef mat-header-cell>Ref No.</th>
                                                <td style="width: 10%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.referenceNo}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="triggeredOn">
                                                <th style="width: 10%;" *matHeaderCellDef mat-header-cell>Triggered On
                                                </th>
                                                <td style="width: 10%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.triggeredOn |
                                                    date:"dd/MMM/yyyy"}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="fromUser">
                                                <th style="width: 10%;" *matHeaderCellDef mat-header-cell>From User</th>
                                                <td style="width: 10%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.fromUser}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="requestNote">
                                                <th style="width: 15%;" *matHeaderCellDef mat-header-cell>Request Note
                                                </th>
                                                <td style="width: 15%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.requestNote}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="toUser">
                                                <th style="width: 10%;" *matHeaderCellDef mat-header-cell>To User</th>
                                                <td style="width: 10%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.toUser}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="referralInput">
                                                <th style="width: 20%;" *matHeaderCellDef mat-header-cell>Referral Input
                                                </th>
                                                <td *matCellDef="let element" mat-cell><span class="truncate"
                                                        style="-webkit-line-clamp: 3; height:57px; margin-bottom: 5px">{{element.referralInput}}</span>
                                                    <a style="cursor: pointer !important;"
                                                        (click)="openReferralInput(element)"
                                                        *ngIf="element.referralInput !== null">View more</a>
                                                </td>
                                            </ng-container>
                                            <ng-container matColumnDef="createdOn">
                                                <th style="width: 10%;" *matHeaderCellDef mat-header-cell>Created On
                                                </th>
                                                <td style="width: 10%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.createdOn |
                                                    date:"dd/MMM/yyyy"}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="status">
                                                <th style="width: 5%;" *matHeaderCellDef mat-header-cell>Status</th>
                                                <td style="width: 5%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>{{element.status}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="sms">
                                                <th style="width: 5%;" *matHeaderCellDef mat-header-cell>SMS</th>
                                                <td style="width: 5%; padding-bottom: 14px;" *matCellDef="let element"
                                                    mat-cell>
                                                    <mat-icon (click)="sendSMS()" style="cursor: pointer;">sms
                                                    </mat-icon>
                                                </td>
                                            </ng-container>
                                            <!--<ng-container matColumnDef="email">
                                                <th *matHeaderCellDef mat-header-cell>Email</th>
                                                <td *matCellDef="let element" mat-cell>
                                                    <mat-icon (click)="sendEmail()" style="cursor: pointer;">email
                                                    </mat-icon>
                                                </td>
                                            </ng-container>-->
                                            <tr *matHeaderRowDef="refCols" mat-header-row></tr>
                                            <tr *matRowDef="let row; columns: refCols;" mat-row></tr>
                                        </table>
                                        <div>
                                            <mat-paginator #paginator [length]="refDataLength"
                                                [pageSizeOptions]="[10, 15, 20]" [pageSize]="10" showFirstLastButtons>
                                            </mat-paginator>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div *ngIf="activeTabId == 6" style="margin-left: 1.7%; margin-right: 1.7%;">
                            <p class="sub-heading">Decision</p>
                            <form [formGroup]="decisionform">
                                <div class="row mx-0">
                                    <div class="col-4">
                                        <!-- <mat-form-field class="input-margin" appearance="outline"> -->
                                        <mat-label class="text-muted">{{nodeDetails.Question }}</mat-label>
                                        <mat-radio-group aria-label="Select an option" class="radio-group">
                                            <mat-radio-button (change)="onProcessChange($event)"
                                                *ngFor="let outLink of outLinks" [checked]="outLink.checked"
                                                [value]="outLink" class="radio-button">{{outLink.actionCaption}}
                                            </mat-radio-button>

                                        </mat-radio-group>
                                        <!-- </mat-form-field> -->

                                        <div class="row">
                                            <div class="col-md-10">
                                                <mat-form-field appearance="outline" class="input-margin">
                                                    <mat-label>Assigned to user</mat-label>
                                                    <mat-select [disabled]="decisionSelected"
                                                        (selectionChange)="assignedUserSelected($event.value)"
                                                        formControlName="assignedToUserId"
                                                        [(ngModel)]="assignDecisionUser" #searchUserSelect required>
                                                        <mat-option>
                                                            <ngx-mat-select-search [formControl]="searchUserFilterCtrl"
                                                                [ngModelOptions]="{ standalone: true }"
                                                                placeholderLabel="Search..."
                                                                noEntriesFoundLabel="'No result found'">
                                                            </ngx-mat-select-search>
                                                        </mat-option>
                                                        <mat-option *ngFor="let x of assignedFilteredUsers | async"
                                                            [value]="x.userId">
                                                            {{x.firstName + ' ' + x.surname}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                            <div class="col-md-1 icon">
                                                <mat-icon aria-label="Button that shows a red tooltip"
                                                    class="multiline-tooltip t-button" matTooltip="{{tooltipText}}"
                                                    style="cursor: pointer;" (click)="employeedetails()">
                                                    error_outline
                                                </mat-icon>
                                            </div>
                                            <!-- <div class="col-md-1 mt-2 icon">
                                                <mat-icon aria-label="Button that shows a red tooltip"
                                                          class="t-button"
                                                          matTooltip="{{tooltipText}}"
                                                          matTooltipClass="multiline-tooltip">
                                                    error_outline
                                                </mat-icon>
                                            </div> -->
                                        </div>


                                    </div>
                                </div>


                                <div class="row  mx-0">
                                    <div class="col-9">

                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label class="text-muted">Note</mat-label>
                                            <textarea [readonly]="decisionSelected" formControlName="notes" matInput
                                                required style="color: black;" #decisionNote></textarea>
                                            <span class="pull-right char" style="color: black;"><em>{{ 1000 -
                                                    decisionNote?.value?.length }} characters left</em></span>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div *ngIf="nodedetailsnext != null" class="row  mx-0">
                                    <div class="col-md-4">
                                        <!-- <mat-label class="text-muted">Note</mat-label> -->
                                        <div style="border: 1px solid #cccccc;  height: 250px;border-radius: 7px;">
                                            <div class="cell">
                                                <p style="margin-top: 15px; margin-left: 15px; color: white;">
                                                    {{nodeDetails?.formName}}
                                                </p>
                                            </div>
                                            <p style="margin-top: 15px; margin-left: 15px;">
                                                {{nodeDetails?.Description}}
                                            </p>
                                        </div>

                                    </div>
                                    <div *ngIf="nodedetailsnext.FormID != '0'" class="col-md-1">
                                        <mat-icon style="margin-top: 125px; font-size: 50px;">arrow_right_alt</mat-icon>
                                    </div>
                                    <div *ngIf="nodedetailsnext.FormID != '0'" class="col-md-4">
                                        <!-- <mat-label class="text-muted">Note</mat-label> -->
                                        <div style="border: 1px solid #cccccc; height: 250px;border-radius: 7px;">
                                            <div class="cell1">
                                                <p style="margin-top: 15px; margin-left: 15px;">
                                                    {{formHeading}}
                                                </p>
                                            </div>
                                            <p style="margin-top: 15px; margin-left: 15px;">
                                                {{formDescription}}
                                            </p>
                                            <hr>
                                            <p style="margin-top: 15px; margin-left: 15px;">Process</p>
                                            <hr>


                                            <!-- <mat-radio-group style="margin-top: 15px; margin-left: 15px;" class="radio-group" aria-label="Select an option">
                                                <mat-radio-button class="radio-button" [checked]="outLink.checked"
                                                     [value]="outLink.NextNodeID"
                                                    *ngFor="let outLink of nextOutLinks">{{outLink.ActionCaption}}
                                                </mat-radio-button>
    
                                            </mat-radio-group> -->
                                        </div>

                                    </div>
                                </div>
                                <div class="row mx-0 absolute absoluteNew">
                                    <div class="col p-0">
                                        <div>
                                            <button mat-raised-button (click)="submitDecision()"
                                                class="submit-button submit bhover float-right">Submit
                                            </button>
                                            <button mat-raised-button (click)="close()"
                                                class="back-button cancel back float-right">Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div *ngIf="activeTabId == 6" class="col-md-2 box">
                        <div>
                            <p class="desc-text" style="margin-bottom: 0;">Request Code:</p>
                            <p class="text" style="margin-top: 0;">{{taskDetail.referenceNo}}</p>
                        </div>
                        <div>
                            <p class="desc-text" style="margin-bottom: 0;">Task Type:</p>
                            <p class="text" style="margin-top: 0;">{{taskDetail.processName}}</p>
                        </div>
                        <div>
                            <p class="desc-text" style="margin-bottom: 0;">Task Situation:</p>
                            <p class="text" style="margin-top: 0;">{{taskDetail.priorityName}}</p>
                        </div>
                        <div>
                            <p class="desc-text" style="margin-bottom: 0;">Task Status:</p>
                            <p class="text" style="margin-top: 0;">{{taskDetail.internalStatusCaption}}</p>
                        </div>
                    </div>
                    <div *ngIf="activeTabId == 6" class="dropdown menu">
                        <span [matMenuTriggerFor]="dropdown">
                            <img alt="" src="assets/images/Three dots.png">
                        </span>
                        <mat-menu #dropdown="matMenu">
                            <a (click)="MarkAsPending()" mat-menu-item>
                                <mat-icon>pending_actions</mat-icon>
                                Mark as Pending
                            </a>
                            <a (click)="userdailogReassign()" mat-menu-item>
                                <mat-icon>assignment</mat-icon>
                                <span>ReAssign</span>
                            </a>
                            <a (click)="changeProvince()" mat-menu-item>
                                <mat-icon>edit_location</mat-icon>
                                <span>Change Province</span>
                            </a>
                            <a (click)="userdailogReferralinfo()" mat-menu-item>
                                <mat-icon>supervisor_account</mat-icon>
                                <span>Referral Information</span>
                            </a>
                            <a (click)="cancelTask()" mat-menu-item>
                                <mat-icon>cancel</mat-icon>
                                <span>Cancel Request</span>
                            </a>
                            <a (click)="addToDiary()" mat-menu-item>
                                <mat-icon>date_range</mat-icon>
                                <span>Add to Diary</span>
                            </a>
                            <a (click)="expediteTask()" mat-menu-item>
                                <mat-icon>explore</mat-icon>
                                <span>Expedite Task </span>
                            </a>
                            <a *ngIf="this.taskDetail.internalStatusCaption === 'In Progress'" (click)="closeTask()"
                                mat-menu-item>
                                <mat-icon>lock</mat-icon>
                                <span>Close Task </span>
                            </a>
                            <a *ngIf="this.taskDetail.internalStatusCaption === 'Close'" (click)="reopenTask()"
                                mat-menu-item>
                                <mat-icon>lock_open</mat-icon>
                                <span>Reopen Task </span>
                            </a>
                            <a (click)="sendtosection()" mat-menu-item>
                                <mat-icon>explore</mat-icon>
                                <span>Send To Section </span>
                            </a>
                        </mat-menu>
                        <!-- <mat-menu #Expedite_task="matMenu">
                    <button mat-menu-item>High</button>
                    <button mat-menu-item>Medium</button>
                    <button mat-menu-item>Low</button>
                    <button mat-menu-item>Normal</button>

                </mat-menu> -->
                    </div>
                </div>
            </div>
        </div>


        <!--- accroding start here-->
        <div class="mobile-according" id="mobileAccording">


            <div class="col-md-12 box extra-box">

                <div>
                    <p class="desc-text">Request Code:</p>
                    <p class="text">REQ1561</p>
                </div>
                <div>
                    <p class="desc-text">Task Type:</p>
                    <p class="text">Info Request</p>
                </div>
                <div>
                    <p class="desc-text">Task Situation:</p>
                    <p class="text">Priority</p>
                </div>
                <div>
                    <p class="desc-text">Task Status:</p>
                    <p class="text">Open</p>
                </div>

            </div>


            <mat-accordion class="example-headers-align">
                <mat-expansion-panel (opened)="setStep(0)" [expanded]="step === 0" hideToggle>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <img alt="" class="icon-acc" src="assets/images/bootstrap-icons/briefcase.svg">
                            <p class="desc-text">Requestor's Information</p>
                            <p class="info-text">Basic info of the requestor.</p>
                        </mat-panel-title>
                        <!-- <mat-panel-description>
            Type your name and age
            <mat-icon>account_circle</mat-icon>
          </mat-panel-description> -->
                    </mat-expansion-panel-header>

                    <div class="accor-cnt">
                        <p class="sub-heading">Requestor's Information</p>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                                <mat-form-field appearance="outline" class="input-margin">
                                    <mat-label>Email</mat-label>
                                    <input matInput />
                                </mat-form-field>
                                <span class="row">
                                    <span class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>First Name</mat-label>
                                            <input matInput />
                                        </mat-form-field>
                                    </span>
                                    <span class="col-xs-12 col-sm-12 col-md-12 col-lg-6">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Last Name</mat-label>
                                            <input matInput />
                                        </mat-form-field>
                                    </span>
                                </span>
                                <mat-form-field appearance="outline" class="input-margin">
                                    <mat-label>Request Type</mat-label>
                                    <mat-select matInput>
                                        <mat-option *ngFor="let x of types" [value]="x">
                                            {{ x.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <span class="row">
                                    <span class="col-xs-12 col-sm-12 col-md-12 col-lg-9">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Data Delivery Media</mat-label>
                                            <mat-select matInput>
                                                <mat-option *ngFor="let x of types" [value]="x">
                                                    {{ x.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </span>
                                </span>
                                <span class="row">
                                    <span class="col-xs-12 col-sm-12 col-md-12 col-lg-9">
                                        <mat-form-field appearance="outline" class="input-margin">
                                            <mat-label>Delivery Method</mat-label>
                                            <mat-select matInput>
                                                <mat-option *ngFor="let x of types" [value]="x">
                                                    {{ x.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </span>
                                </span>
                            </div>
                        </div>

                        <div class="btn-section">
                            <button class="back-button btn1 province">Move to Province</button>
                            <button class="back-button btn1 officer">Assign to Officer</button>
                            <button class="submit-button btn1 submit">Submit</button>
                            <button (click)="close()" class="back-button btn1 cancel">Cancel</button>

                        </div>

                    </div>
                </mat-expansion-panel>


                <mat-expansion-panel (opened)="setStep(1)" [expanded]="step === 1" hideToggle>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <img alt="" class="icon-acc" src="assets/images/bootstrap-icons/person-circle.svg">
                            <p class="desc-text">Request Item</p>
                            <p class="info-text">Basic info of the requestor.</p>
                        </mat-panel-title>

                    </mat-expansion-panel-header>

                    <div class="accor-cnt">
                        <p class="sub-heading">Request Items</p>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 padd-left padd-right">
                                <div class="card card-1 scroll">
                                    <table [dataSource]="itemDataSource" class="table-margin" mat-table>
                                        <ng-container matColumnDef="items">
                                            <th *matHeaderCellDef mat-header-cell>Items</th>
                                            <td *matCellDef="let element" mat-cell>{{element.items}}</td>
                                        </ng-container>
                                        <ng-container matColumnDef="actions">
                                            <th *matHeaderCellDef mat-header-cell>Actions</th>
                                            <td *matCellDef="let element" class="table-bold-text" mat-cell
                                                style="cursor: pointer;">Request Details
                                            </td>
                                        </ng-container>
                                        <ng-container matColumnDef="cost">
                                            <th *matHeaderCellDef mat-header-cell>Cost</th>
                                            <td *matCellDef="let element" mat-cell></td>
                                        </ng-container>
                                        <tr *matHeaderRowDef="itemColumns" mat-header-row></tr>
                                        <tr *matRowDef="let row; columns: itemColumns;" mat-row></tr>
                                    </table>
                                    <div class="row">
                                        <span class="col-12">
                                            <button class="back-button float-right"
                                                style="margin-right: 12px; margin-bottom: 12px;">
                                                <img alt="" src="assets/images/bootstrap-icons/plus.svg">
                                                Add Cost Items
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="btn-section">
                            <button class="back-button btn1 province">Move to Province</button>
                            <button class="back-button btn1 officer">Assign to Officer</button>
                            <button class="submit-button btn1 submit">Submit</button>
                            <button (click)="close()" class="back-button btn1 cancel">Cancel</button>

                        </div>
                    </div>
                </mat-expansion-panel>


                <mat-expansion-panel (opened)="setStep(2)" [expanded]="step === 2" hideToggle>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <img alt="" class="icon-acc" src="assets/images/bootstrap-icons/lock.svg">
                            <p class="desc-text">Request Flow</p>
                            <p class="info-text">Basic info of the requestor.</p>
                        </mat-panel-title>

                    </mat-expansion-panel-header>

                    <div class="accor-cnt">
                        <p class="sub-heading">Request Items</p>
                        <div class="row mx-0 w-75 justify-content-between">
                            <p class="text">Request Code: <span class="color">REQ1561</span></p>
                            <p class="text">Task Open Date: <span class="color">20/09/2020 05:12:09</span></p>
                            <p class="text">Task Code: <span class="color">TASK0003005</span></p>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 padd-left padd-right">
                                <div class="card card-1 scroll">
                                    <table [dataSource]="flowDataSource" class="table-margin" mat-table>
                                        <ng-container matColumnDef="date">
                                            <th *matHeaderCellDef mat-header-cell>Date</th>
                                            <td *matCellDef="let element" mat-cell>{{element.date}}</td>
                                        </ng-container>
                                        <ng-container matColumnDef="user">
                                            <th *matHeaderCellDef mat-header-cell>User</th>
                                            <td *matCellDef="let element" mat-cell>{{element.user}}</td>
                                        </ng-container>
                                        <ng-container matColumnDef="action">
                                            <th *matHeaderCellDef mat-header-cell style="border-top-right-radius: 0px;
                                            border-bottom-right-radius: 0px;">Action</th>
                                            <td *matCellDef="let element" mat-cell>{{element.action}}</td>
                                        </ng-container>
                                        <ng-container matColumnDef="duration">
                                            <th *matHeaderCellDef mat-header-cell>Duration</th>
                                            <td *matCellDef="let element" mat-cell>{{element.duration}}</td>
                                        </ng-container>
                                        <ng-container matColumnDef="note">
                                            <th *matHeaderCellDef mat-header-cell>Notes</th>
                                            <td class="truncate" *matCellDef="let element" mat-cell>{{element.note}}
                                            </td>
                                        </ng-container>
                                        <tr *matHeaderRowDef="flowColumns" mat-header-row></tr>
                                        <tr *matRowDef="let row; columns: flowColumns;" mat-row></tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="btn-section">
                            <button class="back-button btn1 province">Move to Province</button>
                            <button class="back-button btn1 officer">Assign to Officer</button>
                            <button class="submit-button btn1 submit">Submit</button>
                            <button (click)="close()" class="back-button btn1 cancel">Cancel</button>

                        </div>
                    </div>
                </mat-expansion-panel>

                <mat-expansion-panel (opened)="setStep(3)" [expanded]="step === 3" hideToggle>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <img alt="" class="icon-acc" src="assets/images/bootstrap-icons/question-octagon.svg">
                            <p class="desc-text">Supporting Documents</p>
                            <p class="info-text">Basic info of the requestor.</p>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="accor-cnt">
                        <p class="sub-heading">Supporting Documents</p>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-4">
                                <mat-form-field appearance="outline">
                                    <!-- <mat-label *ngIf="selectedRequestFiles; else newRequestFile">{{selectedRequestFiles.item(0).name}}</mat-label> -->
                                    <!-- <ng-template #newFile> -->
                                    <mat-label>Attach Request Document</mat-label>
                                    <!-- </ng-template> -->
                                    <input disabled matInput />
                                    <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                        <mat-icon class="attach">attach_file</mat-icon>
                                    </button>
                                    <input #fileInput (change)="selectFile($event)" hidden id="file" type="file">
                                </mat-form-field>
                                <mat-form-field appearance="outline">
                                    <!-- <mat-label *ngIf="selectedPaymentFiles; else newFile">{{selectedPaymentFiles.item(0).name}}</mat-label> -->
                                    <mat-label>Payment Confirmation</mat-label>
                                    <input disabled matInput />
                                    <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                        <mat-icon class="attach">attach_file</mat-icon>
                                    </button>
                                    <input #fileInput (change)="selectFile($event)" hidden id="file" type="file">
                                </mat-form-field>
                                <mat-form-field appearance="outline">
                                    <!-- <mat-label *ngIf="selectedInvoiceFiles; else newFile">{{selectedInvoiceFiles.item(0).name}}</mat-label> -->
                                    <mat-label>Invoice</mat-label>
                                    <input disabled matInput />
                                    <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                        <mat-icon class="attach">attach_file</mat-icon>
                                    </button>
                                    <input #fileInput (change)="selectFile($event)" hidden id="file" type="file">
                                </mat-form-field>
                                <mat-form-field appearance="outline">
                                    <!-- <mat-label *ngIf="selectedSupportingFiles; else newFile">{{selectedSupportingFiles.item(0).name}} -->
                                    <!-- </mat-label> -->
                                    <mat-label>Supporting Documents</mat-label>
                                    <input disabled matInput />
                                    <button (click)="fileInput.click()" mat-icon-button matSuffix>
                                        <mat-icon class="attach">attach_file</mat-icon>
                                    </button>
                                    <input #fileInput (change)="selectFile($event)" hidden id="file" type="file">
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="btn-section">
                            <button class="back-button btn1 province">Move to Province</button>
                            <button class="back-button btn1 province">Move to Section</button>
                            <button class="back-button btn1 officer">Assign to Officer</button>
                            <button class="submit-button btn1 submit">Submit</button>
                            <button (click)="close()" class="back-button btn1 cancel">Cancel</button>

                        </div>
                    </div>
                </mat-expansion-panel>

            </mat-accordion>
        </div>


        <!-- </div> -->